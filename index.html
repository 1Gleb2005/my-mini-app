<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CONTROL CENTER</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background: #000000;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 8px;
        }

        .game-container {
            width: 100%;
            max-width: 380px;
            background: #000000;
            border-radius: 24px;
            padding: 16px;
            border: 2px solid #8a2be2;
            box-shadow: 0 0 20px rgba(138, 43, 226, 0.3);
        }

        /* CONTROL CENTER –∑–∞–≥–æ–ª–æ–≤–æ–∫ */
        .control-center-header {
            color: #8a2be2;
            font-size: 24px;
            font-weight: 700;
            text-align: center;
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: 0 0 10px #8a2be2;
            border-bottom: 1px solid #8a2be2;
            padding-bottom: 10px;
        }

        /* –ß–µ—Ç—ã—Ä–µ –∫–Ω–æ–ø–∫–∏ –º–µ–Ω—é */
        .menu-buttons {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .menu-btn {
            flex: 1;
            min-width: 70px;
            background: #000000;
            border: 2px solid #8a2be2;
            border-radius: 30px;
            padding: 12px 0;
            color: #8a2be2;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }

        .menu-btn.active {
            background: #8a2be2;
            color: white;
            border-color: #8a2be2;
            box-shadow: 0 0 15px #8a2be2;
        }

        .menu-btn:active {
            transform: scale(0.96);
        }

        /* –ë–∞–ª–∞–Ω—Å - –ø—É—Å—Ç–æ–π */
        .balance-row {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin-bottom: 20px;
            background: #000000;
            border: 1px solid #8a2be2;
            border-radius: 50px;
            padding: 12px 16px;
        }

        .balance-item {
            padding: 5px 15px;
            border-radius: 30px;
            font-size: 16px;
            font-weight: 700;
            color: #ffffff;
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(138, 43, 226, 0.1);
            border: 1px solid #8a2be2;
        }

        .currency-icon {
            font-size: 20px;
            color: #8a2be2;
        }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Ä–∞–∑–¥–µ–ª–æ–≤ */
        .section {
            display: none;
        }

        .section.active {
            display: block;
        }

        /* –ò–≥—Ä–æ–≤–∞—è –æ–±–ª–∞—Å—Ç—å */
        .game-area {
            background: #000000;
            border-radius: 20px;
            padding: 12px;
            margin-bottom: 12px;
            border: 2px solid #8a2be2;
            aspect-ratio: 1/1;
            position: relative;
            box-shadow: inset 0 0 20px rgba(138, 43, 226, 0.2);
        }

        #gameCanvas {
            width: 100%;
            height: 100%;
            display: block;
            border-radius: 12px;
            background: #000000;
        }

        .multiplier {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 42px;
            font-weight: 800;
            color: #ffffff;
            text-shadow: 0 0 20px #8a2be2;
            z-index: 10;
            background: rgba(0,0,0,0.7);
            padding: 8px 24px;
            border-radius: 40px;
            backdrop-filter: blur(4px);
            border: 1px solid #8a2be2;
        }

        /* –ò—Å—Ç–æ—Ä–∏—è */
        .history-container {
            background: #000000;
            border-radius: 16px;
            padding: 12px;
            margin-bottom: 16px;
            border: 1px solid #8a2be2;
        }

        .history-label {
            color: #8a2be2;
            font-size: 12px;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        #history {
            display: flex;
            flex-direction: column;
            gap: 4px;
            max-height: 100px;
            overflow-y: auto;
            padding: 4px;
            scrollbar-width: thin;
            scrollbar-color: #8a2be2 #000000;
        }

        #history::-webkit-scrollbar {
            width: 3px;
        }

        #history::-webkit-scrollbar-thumb {
            background: #8a2be2;
            border-radius: 3px;
        }

        .hist-item {
            background: #000000;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            border: 1px solid #8a2be2;
            color: #8a2be2;
            display: flex;
            justify-content: space-between;
        }

        /* –°—Ç–∞–≤–∫–∞ */
        .bet-section {
            background: #000000;
            border-radius: 20px;
            padding: 16px;
            border: 1px solid #8a2be2;
        }

        .bet-input-row {
            display: flex;
            gap: 8px;
            margin-bottom: 16px;
        }

        #bet-input {
            flex: 1;
            background: #000000;
            border: 1px solid #8a2be2;
            border-radius: 30px;
            padding: 14px 16px;
            color: white;
            font-size: 18px;
            font-weight: 600;
            outline: none;
        }

        #bet-input:focus {
            border-color: #9b4dff;
            box-shadow: 0 0 10px #8a2be2;
        }

        .currency-selector {
            display: flex;
            background: #000000;
            border-radius: 30px;
            padding: 4px;
            border: 1px solid #8a2be2;
            margin-bottom: 12px;
        }

        .curr-btn {
            flex: 1;
            background: none;
            border: none;
            color: #8a2be2;
            font-weight: 600;
            font-size: 14px;
            padding: 8px 0;
            border-radius: 30px;
            transition: all 0.2s;
            cursor: pointer;
        }

        .curr-btn.active {
            background: #8a2be2;
            color: white;
        }

        .action-buttons {
            display: flex;
            gap: 12px;
            margin-top: 16px;
        }

        .btn {
            flex: 1;
            border: none;
            border-radius: 40px;
            padding: 16px;
            font-size: 18px;
            font-weight: 700;
            transition: all 0.1s;
            cursor: pointer;
        }

        .btn:active {
            transform: scale(0.96);
        }

        .btn-primary {
            background: #8a2be2;
            color: white;
            border: 2px solid #8a2be2;
        }

        .btn-success {
            background: #8a2be2;
            color: white;
            border: 2px solid #8a2be2;
        }

        .hidden {
            display: none !important;
        }

        /* –ë—ã—Å—Ç—Ä—ã–µ —Å—Ç–∞–≤–∫–∏ */
        .quick-bets {
            display: flex;
            gap: 8px;
            margin-top: 12px;
        }

        .quick-btn {
            flex: 1;
            background: #000000;
            border: 1px solid #8a2be2;
            border-radius: 20px;
            padding: 8px;
            color: #8a2be2;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
        }

        .quick-btn:active {
            background: #1a1a1a;
        }

        /* –ü—Ä–æ—Ñ–∏–ª—å */
        .profile-header {
            background: #000000;
            border-radius: 20px;
            padding: 20px;
            text-align: center;
            margin-bottom: 12px;
            border: 1px solid #8a2be2;
        }

        .profile-avatar {
            width: 80px;
            height: 80px;
            background: #8a2be2;
            border-radius: 40px;
            margin: 0 auto 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            color: white;
            border: 2px solid #8a2be2;
            box-shadow: 0 0 20px #8a2be2;
            overflow: hidden;
        }

        .profile-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .profile-name {
            color: white;
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .profile-id {
            color: #8a2be2;
            font-size: 12px;
            margin-bottom: 16px;
        }

        .profile-stats {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 16px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            color: white;
            font-size: 18px;
            font-weight: 700;
        }

        .stat-label {
            color: #8a2be2;
            font-size: 12px;
        }

        /* TON Connect —Å—Ç–∏–ª–∏ */
        .ton-connect-section {
            background: #000000;
            border-radius: 20px;
            padding: 20px;
            border: 2px solid #8a2be2;
            margin-bottom: 16px;
            text-align: center;
        }

        .ton-connect-title {
            color: #8a2be2;
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 20px;
        }

        .ton-connect-qr {
            width: 200px;
            height: 200px;
            background: #ffffff;
            margin: 0 auto 20px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            color: #000000;
            position: relative;
            overflow: hidden;
        }

        .ton-connect-text {
            color: #8a2be2;
            font-size: 16px;
            margin-bottom: 20px;
        }

        .wallets-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .wallet-item {
            background: #000000;
            border: 2px solid #8a2be2;
            border-radius: 16px;
            padding: 15px 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .wallet-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(138, 43, 226, 0.3);
        }

        .wallet-item:active {
            transform: scale(0.95);
        }

        .wallet-icon {
            font-size: 32px;
            margin-bottom: 8px;
            color: #8a2be2;
        }

        .wallet-name {
            color: white;
            font-size: 14px;
            font-weight: 600;
        }

        .wallet-badge {
            background: #8a2be2;
            color: white;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 10px;
            margin-top: 5px;
            display: inline-block;
        }

        .ton-connect-button {
            background: #8a2be2;
            color: white;
            border: none;
            border-radius: 30px;
            padding: 16px;
            font-size: 18px;
            font-weight: 700;
            width: 100%;
            cursor: pointer;
            transition: all 0.2s;
        }

        .ton-connect-button:active {
            transform: scale(0.96);
            box-shadow: 0 0 20px #8a2be2;
        }

        .view-all-wallets {
            color: #8a2be2;
            font-size: 14px;
            margin-top: 15px;
            cursor: pointer;
            text-decoration: underline;
        }

        /* Telegram Stars –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ */
        .stars-section {
            background: #000000;
            border-radius: 20px;
            padding: 20px;
            border: 2px solid #8a2be2;
            margin-bottom: 16px;
        }

        .stars-title {
            color: #8a2be2;
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 20px;
            text-align: center;
        }

        .stars-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .stars-item {
            background: #000000;
            border: 2px solid #8a2be2;
            border-radius: 16px;
            padding: 20px 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .stars-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(138, 43, 226, 0.3);
        }

        .stars-item:active {
            transform: scale(0.95);
        }

        .stars-icon {
            font-size: 32px;
            margin-bottom: 10px;
            color: #8a2be2;
        }

        .stars-amount {
            color: white;
            font-weight: 700;
            font-size: 18px;
            margin-bottom: 5px;
        }

        .stars-price {
            color: #8a2be2;
            font-size: 14px;
        }

        /* –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å - –ø—É—Å—Ç–æ–π */
        .inventory-empty {
            text-align: center;
            padding: 40px;
            color: #8a2be2;
            border: 2px dashed #8a2be2;
            border-radius: 20px;
            margin-bottom: 12px;
        }

        .inventory-empty-icon {
            font-size: 48px;
            margin-bottom: 10px;
        }

        .inventory-empty-text {
            font-size: 16px;
            margin-bottom: 5px;
        }

        .inventory-empty-sub {
            font-size: 12px;
            opacity: 0.7;
        }

        /* –ö–µ–π—Å—ã */
        .cases-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 12px;
        }

        .case-item {
            background: #000000;
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            border: 2px solid #8a2be2;
            cursor: pointer;
            transition: all 0.2s;
        }

        .case-item:active {
            transform: scale(0.96);
            box-shadow: 0 0 20px #8a2be2;
        }

        .case-icon {
            font-size: 48px;
            margin-bottom: 12px;
        }

        .case-name {
            color: white;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .case-price {
            color: #8a2be2;
            font-size: 16px;
            font-weight: 600;
        }

        /* –ö–Ω–æ–ø–∫–∞ —Ñ–∏–∫—Å–∞—Ü–∏–∏ —Å—Ç–∞–≤–∫–∏ */
        .fix-bet-container {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
        }

        .fix-bet-checkbox {
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: #8a2be2;
        }

        .fix-bet-label {
            color: #8a2be2;
            font-size: 14px;
        }

        /* Win –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä */
        .win-indicator {
            position: absolute;
            top: 80px;
            right: 20px;
            color: #8a2be2;
            font-size: 18px;
            font-weight: bold;
            text-shadow: 0 0 10px #8a2be2;
            z-index: 10;
        }

        /* –°—Ç—Ä–æ–∫–∞ —Å—Ç–∞–≤–æ–∫ */
        .bets-list {
            background: #000000;
            border-radius: 16px;
            padding: 12px;
            margin-top: 12px;
            border: 1px solid #8a2be2;
            max-height: 150px;
            overflow-y: auto;
        }

        .bets-title {
            color: #8a2be2;
            font-size: 12px;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .bet-item {
            display: flex;
            justify-content: space-between;
            padding: 6px 8px;
            border-bottom: 1px solid #333;
            color: white;
            font-size: 12px;
        }

        .bet-item:last-child {
            border-bottom: none;
        }

        .bet-user {
            color: #8a2be2;
        }

        .bet-amount {
            color: #ffd966;
        }

        .bet-mult {
            color: #2ecc71;
        }

        .bet-crashed {
            color: #ff4757;
        }

        /* –¢–µ—Ä–º–∏–Ω–∞–ª –¥–ª—è –∞–¥–º–∏–Ω–∞ */
        .admin-terminal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.95);
            z-index: 2000;
            padding: 20px;
            overflow-y: auto;
        }

        .admin-terminal.active {
            display: block;
        }

        .terminal-content {
            background: #000000;
            border: 2px solid #8a2be2;
            border-radius: 20px;
            padding: 20px;
            max-width: 400px;
            margin: 50px auto;
        }

        .terminal-title {
            color: #8a2be2;
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 20px;
            text-align: center;
        }

        .terminal-input {
            width: 100%;
            background: #000000;
            border: 1px solid #8a2be2;
            border-radius: 30px;
            padding: 12px;
            color: white;
            margin-bottom: 10px;
            outline: none;
        }

        .terminal-select {
            width: 100%;
            background: #000000;
            border: 1px solid #8a2be2;
            border-radius: 30px;
            padding: 12px;
            color: white;
            margin-bottom: 10px;
            outline: none;
        }

        .terminal-button {
            background: #8a2be2;
            color: white;
            border: none;
            border-radius: 30px;
            padding: 12px;
            font-size: 16px;
            font-weight: 600;
            width: 100%;
            margin-bottom: 10px;
            cursor: pointer;
        }

        .terminal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            color: #8a2be2;
            font-size: 30px;
            cursor: pointer;
        }
    </style>
    
    <!-- TON Connect –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ -->
    <script src="https://unpkg.com/@tonconnect/sdk@latest/dist/tonconnect-sdk.min.js"></script>
</head>
<body>
    <div class="game-container">
        <!-- CONTROL CENTER –∑–∞–≥–æ–ª–æ–≤–æ–∫ -->
        <div class="control-center-header">CONTROL CENTER</div>

        <!-- –ë–∞–ª–∞–Ω—Å - –ø—É—Å—Ç–æ–π -->
        <div class="balance-row">
            <div class="balance-item">
                <span class="currency-icon">TON</span>
                <span id="balance-ton">0</span>
            </div>
            <div class="balance-item">
                <span class="currency-icon">‚≠ê</span>
                <span id="balance-stars">0</span>
            </div>
        </div>

        <!-- –ß–µ—Ç—ã—Ä–µ –∫–Ω–æ–ø–∫–∏ –º–µ–Ω—é -->
        <div class="menu-buttons">
            <button class="menu-btn active" data-section="profile">–ü—Ä–æ—Ñ–∏–ª—å</button>
            <button class="menu-btn" data-section="inventory">–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</button>
            <button class="menu-btn" data-section="traffic">–†–∞–∫–µ—Ç–∞</button>
            <button class="menu-btn" data-section="cases">–ö–µ–π—Å—ã</button>
        </div>

        <!-- –°–µ–∫—Ü–∏—è –ü—Ä–æ—Ñ–∏–ª—å -->
        <div id="profile-section" class="section active">
            <div class="profile-header">
                <div class="profile-avatar" id="profileAvatar">
                    üë§
                </div>
                <div class="profile-name" id="profileName">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                <div class="profile-id" id="profileId">ID: ...</div>
                <div class="profile-stats">
                    <div class="stat-item">
                        <div class="stat-value" id="profileGames">0</div>
                        <div class="stat-label">–ò–≥—Ä</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="profileWins">0</div>
                        <div class="stat-label">–ü–æ–±–µ–¥</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="profileAvg">0x</div>
                        <div class="stat-label">–°—Ä. –º–Ω–æ–∂–∏—Ç–µ–ª—å</div>
                    </div>
                </div>
            </div>

            <!-- TON Connect -->
            <div class="ton-connect-section">
                <div class="ton-connect-title">Connect your TON wallet</div>
                <div class="ton-connect-qr" id="tonQRCode">
                    TON
                </div>
                <div class="ton-connect-text">Scan with your mobile wallet</div>
                
                <div class="wallets-grid">
                    <div class="wallet-item" onclick="connectWallet('telegram')">
                        <div class="wallet-icon">‚úàÔ∏è</div>
                        <div class="wallet-name">Wallet in Telegram</div>
                    </div>
                    <div class="wallet-item" onclick="connectWallet('tonkeeper')">
                        <div class="wallet-icon">TON</div>
                        <div class="wallet-name">Tonkeeper</div>
                        <div class="wallet-badge">Popular</div>
                    </div>
                    <div class="wallet-item" onclick="connectWallet('mytonwallet')">
                        <div class="wallet-icon">üì±</div>
                        <div class="wallet-name">MyTonWallet</div>
                    </div>
                    <div class="wallet-item" onclick="connectWallet('all')">
                        <div class="wallet-icon">üîç</div>
                        <div class="wallet-name">View all wallets</div>
                    </div>
                </div>
                
                <button class="ton-connect-button" onclick="tonConnect()">
                    TON Connect
                </button>
                
                <div class="view-all-wallets" onclick="showAllWallets()">
                    View all wallets ‚Üí
                </div>
            </div>

            <!-- Telegram Stars –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ -->
            <div class="stars-section">
                <div class="stars-title">Telegram Stars ‚≠ê</div>
                <div class="stars-grid">
                    <div class="stars-item" onclick="buyStars(50)">
                        <div class="stars-icon">‚≠ê</div>
                        <div class="stars-amount">50 Stars</div>
                        <div class="stars-price">50 ‚≠ê</div>
                    </div>
                    <div class="stars-item" onclick="buyStars(100)">
                        <div class="stars-icon">‚≠ê</div>
                        <div class="stars-amount">100 Stars</div>
                        <div class="stars-price">100 ‚≠ê</div>
                    </div>
                    <div class="stars-item" onclick="buyStars(250)">
                        <div class="stars-icon">‚≠ê</div>
                        <div class="stars-amount">250 Stars</div>
                        <div class="stars-price">250 ‚≠ê</div>
                    </div>
                    <div class="stars-item" onclick="buyStars(500)">
                        <div class="stars-icon">‚≠ê</div>
                        <div class="stars-amount">500 Stars</div>
                        <div class="stars-price">500 ‚≠ê</div>
                    </div>
                </div>
                
                <button class="ton-connect-button" onclick="buyStars(1000)" style="background: #2AABEE;">
                    –ö—É–ø–∏—Ç—å —á–µ—Ä–µ–∑ Telegram Stars
                </button>
            </div>
            
            <div class="bet-section">
                <h3 style="color: #8a2be2; margin-bottom: 12px;">–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h3>
                <div style="background: #000000; border-radius: 12px; padding: 12px; margin-bottom: 8px; border: 1px solid #8a2be2;">
                    <div style="display: flex; justify-content: space-between; color: white;">
                        <span>üî• –ü–µ—Ä–≤–∞—è –∏–≥—Ä–∞</span>
                        <span style="color: #8a2be2;">0/1</span>
                    </div>
                </div>
                <div style="background: #000000; border-radius: 12px; padding: 12px; margin-bottom: 8px; border: 1px solid #8a2be2;">
                    <div style="display: flex; justify-content: space-between; color: white;">
                        <span>‚ö° –ü–µ—Ä–≤—ã–π –≤—ã–∏–≥—Ä—ã—à</span>
                        <span style="color: #8a2be2;">0/1</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- –°–µ–∫—Ü–∏—è –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å - –ø—É—Å—Ç–æ–π -->
        <div id="inventory-section" class="section">
            <div class="inventory-empty">
                <div class="inventory-empty-icon">üì¶</div>
                <div class="inventory-empty-text">–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø—É—Å—Ç</div>
                <div class="inventory-empty-sub">–ö—É–ø–∏—Ç–µ –∫–µ–π—Å—ã —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–µ–¥–º–µ—Ç—ã</div>
            </div>
        </div>

        <!-- –°–µ–∫—Ü–∏—è –†–∞–∫–µ—Ç–∞ -->
        <div id="traffic-section" class="section">
            <!-- –ò–≥—Ä–æ–≤–∞—è –æ–±–ª–∞—Å—Ç—å -->
            <div class="game-area" id="game-area">
                <div class="multiplier" id="multiplier">1.00x</div>
                <div class="win-indicator hidden" id="win-indicator">‚úì WIN</div>
                <canvas id="gameCanvas"></canvas>
            </div>

            <!-- –°—Ç—Ä–æ–∫–∞ —Å—Ç–∞–≤–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ -->
            <div class="bets-list">
                <div class="bets-title">–ê–∫—Ç–∏–≤–Ω—ã–µ —Å—Ç–∞–≤–∫–∏</div>
                <div id="activeBets">
                    <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è -->
                </div>
            </div>

            <!-- –ò—Å—Ç–æ—Ä–∏—è -->
            <div class="history-container">
                <div class="history-label">–ò—Å—Ç–æ—Ä–∏—è –∏–≥—Ä</div>
                <div id="history"></div>
            </div>

            <!-- –°—Ç–∞–≤–∫–∞ -->
            <div class="bet-section">
                <div class="fix-bet-container">
                    <input type="checkbox" id="fix-bet" class="fix-bet-checkbox">
                    <label for="fix-bet" class="fix-bet-label">–§–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞–≤–∫—É</label>
                </div>

                <!-- –í—ã–±–æ—Ä –≤–∞–ª—é—Ç—ã –Ω–∞–¥ –∫–Ω–æ–ø–∫–æ–π -->
                <div class="currency-selector">
                    <button class="curr-btn active" data-curr="ton">TON</button>
                    <button class="curr-btn" data-curr="stars">STARS</button>
                </div>

                <div class="bet-input-row">
                    <input type="number" id="bet-input" min="0.1" step="0.1" value="1.0">
                </div>

                <!-- –ë—ã—Å—Ç—Ä—ã–µ —Å—Ç–∞–≤–∫–∏ -->
                <div class="quick-bets">
                    <button class="quick-btn" data-mult="2">2x</button>
                    <button class="quick-btn" data-mult="5">5x</button>
                    <button class="quick-btn" data-mult="10">10x</button>
                    <button class="quick-btn" data-mult="50">50x</button>
                </div>

                <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
                <div class="action-buttons">
                    <button class="btn btn-primary" id="bet-btn">–ü–æ—Å—Ç–∞–≤–∏—Ç—å</button>
                    <button class="btn btn-success hidden" id="cash-btn">–ó–∞–±—Ä–∞—Ç—å</button>
                </div>
            </div>
        </div>

        <!-- –°–µ–∫—Ü–∏—è –ö–µ–π—Å—ã -->
        <div id="cases-section" class="section">
            <div class="cases-grid">
                <div class="case-item" onclick="openCase('common')">
                    <div class="case-icon">üì¶</div>
                    <div class="case-name">–û–±—ã—á–Ω—ã–π –∫–µ–π—Å</div>
                    <div class="case-price">50 Stars</div>
                </div>
                <div class="case-item" onclick="openCase('rare')">
                    <div class="case-icon">üéÅ</div>
                    <div class="case-name">–†–µ–¥–∫–∏–π –∫–µ–π—Å</div>
                    <div class="case-price">150 Stars</div>
                </div>
                <div class="case-item" onclick="openCase('epic')">
                    <div class="case-icon">üíé</div>
                    <div class="case-name">–≠–ø–∏—á–µ—Å–∫–∏–π –∫–µ–π—Å</div>
                    <div class="case-price">5 TON</div>
                </div>
                <div class="case-item" onclick="openCase('legendary')">
                    <div class="case-icon">üëë</div>
                    <div class="case-name">–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π</div>
                    <div class="case-price">15 TON</div>
                </div>
            </div>
        </div>
    </div>

    <!-- –¢–µ—Ä–º–∏–Ω–∞–ª –¥–ª—è –∞–¥–º–∏–Ω–∞ -->
    <div class="admin-terminal" id="adminTerminal">
        <div class="terminal-close" onclick="closeAdminTerminal()">‚úï</div>
        <div class="terminal-content">
            <div class="terminal-title">ADMIN TERMINAL</div>
            <input type="text" class="terminal-input" id="adminUserId" placeholder="User ID">
            <select class="terminal-select" id="adminCurrency">
                <option value="ton">TON</option>
                <option value="stars">Stars</option>
            </select>
            <input type="number" class="terminal-input" id="adminAmount" placeholder="Amount">
            <button class="terminal-button" onclick="adminAddBalance()">Add Balance</button>
            <button class="terminal-button" onclick="adminResetStats()">Reset User Stats</button>
            <button class="terminal-button" onclick="adminSetCrashPoint(1.0)">Force Crash 1.0x</button>
        </div>
    </div>

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
        const ADMIN_IDS = [5212904541]; // ID –∞–¥–º–∏–Ω–æ–≤ - –ó–î–ï–°–¨ –ù–£–ñ–ù–û –í–°–¢–ê–í–ò–¢–¨ –†–ï–ê–õ–¨–ù–´–ï ID
        
        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã - –û–î–ò–ù–ê–ö–û–í–û–ï –î–õ–Ø –í–°–ï–•
        let gameState = {
            isPlaying: false,
            multiplier: 1.0,
            crashPoint: 2.5,
            rocket: { y: 0.5 },
            startTime: Date.now()
        };
        
        // –ê–∫—Ç–∏–≤–Ω—ã–µ —Å—Ç–∞–≤–∫–∏ –∏–≥—Ä–æ–∫–æ–≤
        let activeBets = [];
        
        // –ò—Å—Ç–æ—Ä–∏—è –∏–≥—Ä
        let gameHistory = [];
        
        // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
        let currentUser = {
            id: null,
            firstName: '–ò–≥—Ä–æ–∫',
            lastName: '',
            username: '',
            photoUrl: null,
            ton: 0,
            stars: 0,
            games: 0,
            wins: 0,
            totalMultiplier: 0
        };
        
        // Canvas
        let canvas = document.getElementById('gameCanvas');
        let ctx = canvas.getContext('2d');
        let multEl = document.getElementById('multiplier');
        let winIndicator = document.getElementById('win-indicator');
        
        // –¢—Ä–∞—Ñ–∏–∫
        let trafficLines = [];
        const TRAFFIC_COUNT = 25;
        const TRAFFIC_SPEED = 0.04;
        
        // –§–∏–∫—Å–∞—Ü–∏—è —Å—Ç–∞–≤–∫–∏
        let fixBet = false;
        let currentCurr = 'ton';
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram
        function initTelegram() {
            if (window.Telegram?.WebApp) {
                const tg = window.Telegram.WebApp;
                tg.ready();
                tg.expand();
                
                const user = tg.initDataUnsafe?.user;
                if (user) {
                    currentUser.id = user.id;
                    currentUser.firstName = user.first_name || '–ò–≥—Ä–æ–∫';
                    currentUser.lastName = user.last_name || '';
                    currentUser.username = user.username || '';
                    
                    document.getElementById('profileName').innerText = 
                        currentUser.firstName + (currentUser.lastName ? ' ' + currentUser.lastName : '');
                    document.getElementById('profileId').innerText = `ID: ${currentUser.id}`;
                    
                    // –ó–∞–≥—Ä—É–∂–∞–µ–º –∞–≤–∞—Ç–∞—Ä–∫—É –µ—Å–ª–∏ –µ—Å—Ç—å
                    if (user.photo_url) {
                        const avatarDiv = document.getElementById('profileAvatar');
                        avatarDiv.innerHTML = `<img src="${user.photo_url}" alt="avatar">`;
                    }
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–¥–º–∏–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
                    if (ADMIN_IDS.includes(currentUser.id)) {
                        // –î–æ–±–∞–≤–ª—è–µ–º —Å–∫—Ä—ã—Ç—É—é –∫–Ω–æ–ø–∫—É –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è —Ç–µ—Ä–º–∏–Ω–∞–ª–∞
                        const terminalTrigger = document.createElement('div');
                        terminalTrigger.style.position = 'fixed';
                        terminalTrigger.style.bottom = '10px';
                        terminalTrigger.style.right = '10px';
                        terminalTrigger.style.width = '40px';
                        terminalTrigger.style.height = '40px';
                        terminalTrigger.style.background = '#8a2be2';
                        terminalTrigger.style.borderRadius = '20px';
                        terminalTrigger.style.cursor = 'pointer';
                        terminalTrigger.style.zIndex = '1000';
                        terminalTrigger.onclick = openAdminTerminal;
                        document.body.appendChild(terminalTrigger);
                    }
                    
                    // –ó–∞–≥—Ä—É–∂–∞–µ–º –±–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                    loadUserBalance();
                }
            } else {
                // –î–µ–º–æ —Ä–µ–∂–∏–º –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
                currentUser.id = 12345;
                currentUser.firstName = '–¢–µ—Å—Ç–æ–≤—ã–π';
                document.getElementById('profileName').innerText = '–¢–µ—Å—Ç–æ–≤—ã–π –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
                document.getElementById('profileId').innerText = 'ID: 12345';
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –±–∞–ª–∞–Ω—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∑–¥–µ—Å—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—Ä–æ—Å –∫ –±—ç–∫–µ–Ω–¥—É)
        function loadUserBalance() {
            // –≠–º—É–ª—è—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏
            setTimeout(() => {
                updateUI();
            }, 500);
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
        function updateUI() {
            document.getElementById('balance-ton').innerText = currentUser.ton;
            document.getElementById('balance-stars').innerText = currentUser.stars;
            document.getElementById('profileGames').innerText = currentUser.games;
            document.getElementById('profileWins').innerText = currentUser.wins;
            document.getElementById('profileAvg').innerText = 
                currentUser.games > 0 ? (currentUser.totalMultiplier / currentUser.games).toFixed(2) + 'x' : '0x';
        }
        
        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∞–¥–º–∏–Ω–∞
        function openAdminTerminal() {
            if (ADMIN_IDS.includes(currentUser.id)) {
                document.getElementById('adminTerminal').classList.add('active');
            }
        }
        
        function closeAdminTerminal() {
            document.getElementById('adminTerminal').classList.remove('active');
        }
        
        function adminAddBalance() {
            const userId = document.getElementById('adminUserId').value;
            const currency = document.getElementById('adminCurrency').value;
            const amount = parseFloat(document.getElementById('adminAmount').value);
            
            if (!userId || isNaN(amount) || amount <= 0) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }
            
            // –ó–¥–µ—Å—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—Ä–æ—Å –∫ –±—ç–∫–µ–Ω–¥—É –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞
            if (userId === currentUser.id.toString()) {
                if (currency === 'ton') {
                    currentUser.ton += amount;
                } else {
                    currentUser.stars += amount;
                }
                updateUI();
                alert(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é ${userId} –Ω–∞—á–∏—Å–ª–µ–Ω–æ ${amount} ${currency}`);
            } else {
                alert(`–ó–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${userId} –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω (—ç–º—É–ª—è—Ü–∏—è)`);
            }
        }
        
        function adminResetStats() {
            const userId = document.getElementById('adminUserId').value;
            
            if (!userId) {
                alert('–í–≤–µ–¥–∏—Ç–µ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');
                return;
            }
            
            if (userId === currentUser.id.toString()) {
                currentUser.games = 0;
                currentUser.wins = 0;
                currentUser.totalMultiplier = 0;
                updateUI();
                alert('–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–±—Ä–æ—à–µ–Ω–∞');
            }
        }
        
        function adminSetCrashPoint(point) {
            if (gameState.isPlaying) {
                gameState.crashPoint = point;
                alert(`–¢–æ—á–∫–∞ –∫—Ä–∞—à–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –Ω–∞ ${point}x`);
            }
        }
        
        // TON Connect —Ñ—É–Ω–∫—Ü–∏–∏
        function connectWallet(wallet) {
            let walletInfo = {
                telegram: { name: 'Wallet in Telegram', link: 'https://t.me/wallet' },
                tonkeeper: { name: 'Tonkeeper', link: 'https://tonkeeper.com/' },
                mytonwallet: { name: 'MyTonWallet', link: 'https://mytonwallet.app/' },
                all: { name: 'All wallets', link: 'https://ton.org/wallets' }
            };
            
            if (wallet === 'all') {
                showAllWallets();
                return;
            }
            
            if (window.Telegram?.WebApp) {
                window.Telegram.WebApp.openLink(walletInfo[wallet].link);
            } else {
                window.open(walletInfo[wallet].link, '_blank');
            }
        }
        
        function tonConnect() {
            if (window.Telegram?.WebApp) {
                window.Telegram.WebApp.showPopup({
                    title: 'TON Connect',
                    message: 'Connect your TON wallet?',
                    buttons: [
                        {id: 'connect', type: 'default', text: 'Connect'},
                        {id: 'cancel', type: 'cancel', text: 'Cancel'}
                    ]
                }, (buttonId) => {
                    if (buttonId === 'connect') {
                        alert('TON Connect integration ready');
                    }
                });
            }
        }
        
        function showAllWallets() {
            if (window.Telegram?.WebApp) {
                window.Telegram.WebApp.openLink('https://ton.org/wallets');
            }
        }
        
        // –ü–æ–∫—É–ø–∫–∞ Stars
        function buyStars(amount) {
            if (window.Telegram?.WebApp) {
                window.Telegram.WebApp.showPopup({
                    title: '–ü–æ–∫—É–ø–∫–∞ Stars',
                    message: `–ö—É–ø–∏—Ç—å ${amount} Stars –∑–∞ ${amount} Telegram Stars?`,
                    buttons: [
                        {id: 'buy', type: 'default', text: '–ö—É–ø–∏—Ç—å'},
                        {id: 'cancel', type: 'cancel', text: '–û—Ç–º–µ–Ω–∞'}
                    ]
                }, (buttonId) => {
                    if (buttonId === 'buy') {
                        // –ó–¥–µ—Å—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram Stars
                        currentUser.stars += amount;
                        updateUI();
                        window.Telegram.WebApp.showPopup({
                            title: '–£—Å–ø–µ—à–Ω–æ',
                            message: `–í—ã –∫—É–ø–∏–ª–∏ ${amount} Stars!`,
                            buttons: [{id: 'ok', type: 'ok', text: 'OK'}]
                        });
                    }
                });
            }
        }
        
        // –û—Ç–∫—Ä—ã—Ç–∏–µ –∫–µ–π—Å–∞
        function openCase(caseType) {
            const prices = {
                common: { stars: 50 },
                rare: { stars: 150 },
                epic: { ton: 5 },
                legendary: { ton: 15 }
            };
            
            let price = prices[caseType];
            
            if (price.stars && currentUser.stars >= price.stars) {
                currentUser.stars -= price.stars;
                openCaseReward();
            } else if (price.ton && currentUser.ton >= price.ton) {
                currentUser.ton -= price.ton;
                openCaseReward();
            } else {
                if (window.Telegram?.WebApp) {
                    window.Telegram.WebApp.showPopup({
                        title: '–û—à–∏–±–∫–∞',
                        message: '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤',
                        buttons: [{id: 'ok', type: 'ok', text: 'OK'}]
                    });
                }
            }
        }
        
        function openCaseReward() {
            // –≠–º—É–ª—è—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∏—è –∫–µ–π—Å–∞
            if (window.Telegram?.WebApp) {
                window.Telegram.WebApp.showPopup({
                    title: '–ö–µ–π—Å –æ—Ç–∫—Ä—ã—Ç!',
                    message: '–í—ã –ø–æ–ª—É—á–∏–ª–∏ –ø—Ä–µ–¥–º–µ—Ç! (–§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)',
                    buttons: [{id: 'ok', type: 'ok', text: 'OK'}]
                });
            }
            updateUI();
        }
        
        // –ò–≥—Ä–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function initTraffic() {
            trafficLines = [];
            for (let i = 0; i < TRAFFIC_COUNT; i++) {
                trafficLines.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height,
                    speed: 0.3 + Math.random() * 2.5,
                    width: 1 + Math.random() * 4,
                    length: 20 + Math.random() * 50,
                    alpha: 0.2 + Math.random() * 0.7
                });
            }
        }
        
        // –°–µ–∫—Ä–µ—Ç–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è: –µ—Å–ª–∏ —Å—Ç–∞–≤–∫–∞ >= 50 TON, —Ä–∞–∫–µ—Ç–∞ –ø–∞–¥–∞–µ—Ç –Ω–∞ 1x
        function getRandomCrashPoint(betAmount, currency) {
            if (currency === 'ton' && betAmount >= 50) {
                return 1.0; // –°–µ–∫—Ä–µ—Ç–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è - –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –∫—Ä–∞—à
            }
            
            const r = Math.random();
            if (r < 0.4) return 1.2 + Math.random() * 1.5;
            if (r < 0.7) return 2.7 + Math.random() * 3;
            if (r < 0.9) return 5.7 + Math.random() * 6;
            return 11.7 + Math.random() * 20;
        }
        
        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞–≤–∫–∏ –≤ —Å–ø–∏—Å–æ–∫
        function addActiveBet(userId, userName, amount, currency) {
            activeBets.push({
                userId,
                userName,
                amount,
                currency,
                multiplier: gameState.multiplier,
                time: Date.now()
            });
            
            updateBetsList();
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å—Ç–∞–≤–æ–∫
        function updateBetsList() {
            const betsDiv = document.getElementById('activeBets');
            betsDiv.innerHTML = '';
            
            activeBets.forEach(bet => {
                const betItem = document.createElement('div');
                betItem.className = 'bet-item';
                betItem.innerHTML = `
                    <span class="bet-user">${bet.userName}</span>
                    <span class="bet-amount">${bet.amount} ${bet.currency}</span>
                    <span class="bet-mult">${bet.multiplier.toFixed(2)}x</span>
                `;
                betsDiv.appendChild(betItem);
            });
        }
        
        // –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞–≤–æ–∫ –ø–æ—Å–ª–µ –∫—Ä–∞—à–∞
        function clearBets() {
            activeBets = [];
            updateBetsList();
        }
        
        // –§—É–Ω–∫—Ü–∏—è —Å—Ç–∞–≤–∫–∏
        function placeBet() {
            if (gameState.isPlaying) return;
            
            const amt = parseFloat(document.getElementById('bet-input').value);
            if (isNaN(amt) || amt <= 0) return;
            
            if (currentUser[currentCurr] < amt) {
                if (window.Telegram?.WebApp) {
                    window.Telegram.WebApp.showPopup({
                        title: '–û—à–∏–±–∫–∞',
                        message: '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤',
                        buttons: [{id: 'ok', type: 'ok', text: 'OK'}]
                    });
                }
                return;
            }
            
            // –°–ø–∏—Å—ã–≤–∞–µ–º —Å—Ç–∞–≤–∫—É
            currentUser[currentCurr] -= amt;
            currentUser.games++;
            updateUI();
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∞–∫—Ç–∏–≤–Ω—ã–µ —Å—Ç–∞–≤–∫–∏
            addActiveBet(
                currentUser.id,
                currentUser.firstName,
                amt,
                currentCurr
            );
            
            // –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –∏–≥—Ä–µ
            gameState.isPlaying = true;
            gameState.hasCashedOut = false;
            gameState.multiplier = 1.0;
            gameState.crashPoint = getRandomCrashPoint(amt, currentCurr);
            gameState.startTime = Date.now();
            gameState.currentBet = amt;
            
            gameState.rocket.y = 0.5;
            
            initTraffic();
            
            document.getElementById('bet-btn').style.display = 'none';
            document.getElementById('cash-btn').style.display = 'block';
            winIndicator.classList.add('hidden');
            
            if (gameLoop) clearInterval(gameLoop);
            gameLoop = setInterval(update, 50);
        }
        
        // –§—É–Ω–∫—Ü–∏—è –∑–∞–±–∏—Ä–∞–Ω–∏—è –≤—ã–∏–≥—Ä—ã—à–∞
        function cashOut() {
            if (!gameState.isPlaying || gameState.hasCashedOut) return;
            
            const amt = gameState.currentBet;
            const win = amt * gameState.multiplier;
            
            currentUser[currentCurr] += win;
            currentUser.wins++;
            currentUser.totalMultiplier += gameState.multiplier;
            updateUI();
            
            gameState.hasCashedOut = true;
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
            const hist = document.getElementById('history');
            const item = document.createElement('div');
            item.className = 'hist-item';
            item.innerHTML = `
                <span>${currentUser.firstName}</span>
                <span style="color: #ffd966">${amt} ${currentCurr}</span>
                <span style="color: #2ecc71">‚úì ${gameState.multiplier.toFixed(2)}x</span>
            `;
            hist.prepend(item);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ —Å—Ç–∞–≤–∫–∏
            activeBets = activeBets.filter(bet => bet.userId !== currentUser.id);
            updateBetsList();
            
            document.getElementById('cash-btn').style.display = 'none';
            document.getElementById('bet-btn').style.display = 'block';
            document.getElementById('bet-btn').disabled = true;
            document.getElementById('bet-btn').style.opacity = '0.5';
        }
        
        function finishGame(isWin) {
            clearInterval(gameLoop);
            gameState.isPlaying = false;
            
            document.getElementById('bet-btn').disabled = false;
            document.getElementById('bet-btn').style.opacity = '1';
            
            if (!isWin && !gameState.hasCashedOut) {
                // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é –∫—Ä–∞—à
                const hist = document.getElementById('history');
                const item = document.createElement('div');
                item.className = 'hist-item';
                item.innerHTML = `
                    <span>üí• CRASH</span>
                    <span style="color: #ff4757">${gameState.multiplier.toFixed(2)}x</span>
                `;
                hist.prepend(item);
            }
            
            // –û—á–∏—â–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ —Å—Ç–∞–≤–∫–∏
            clearBets();
            
            setTimeout(() => {
                document.getElementById('bet-btn').style.display = 'block';
                document.getElementById('cash-btn').style.display = 'none';
                multEl.style.color = '#ffffff';
                multEl.innerText = '1.00x';
                winIndicator.classList.add('hidden');
                gameState.rocket.y = 0.5;
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                trafficLines = [];
                drawStartScreen();
                
                if (fixBet) {
                    setTimeout(() => {
                        if (!gameState.isPlaying) {
                            placeBet();
                        }
                    }, 2100);
                }
            }, 2000);
        }
        
        // –ò–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª
        function update() {
            if (!gameState.isPlaying) return;
            
            gameState.multiplier += 0.015;
            multEl.innerText = gameState.multiplier.toFixed(2) + 'x';
            
            gameState.rocket.y -= 0.015;
            if (gameState.rocket.y < 0.1) gameState.rocket.y = 0.1;
            
            updateTraffic();
            drawGame();
            
            if (!gameState.hasCashedOut && gameState.multiplier >= gameState.crashPoint) {
                finishGame(false);
            }
        }
        
        function updateTraffic() {
            for (let i = 0; i < trafficLines.length; i++) {
                const line = trafficLines[i];
                line.y -= line.speed * TRAFFIC_SPEED * canvas.height * (0.5 + gameState.multiplier * 0.5);
                
                if (line.y < -line.length) {
                    line.y = canvas.height + Math.random() * 50;
                    line.x = Math.random() * canvas.width;
                    line.speed = 0.3 + Math.random() * 2.5;
                }
            }
        }
        
        function drawGame() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            ctx.fillStyle = '#000000';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            ctx.fillStyle = 'rgba(138, 43, 226, 0.1)';
            for (let i = 0; i < 30; i++) {
                ctx.beginPath();
                ctx.arc(
                    15 + (i * 23) % canvas.width, 
                    25 + (i * 17) % canvas.height, 
                    1 + i % 2, 
                    0, Math.PI * 2
                );
                ctx.fill();
            }
            
            if (trafficLines.length > 0) {
                drawTraffic();
            }
            
            ctx.save();
            ctx.strokeStyle = 'rgba(138, 43, 226, 0.15)';
            ctx.lineWidth = 1.5;
            ctx.setLineDash([8, 12]);
            ctx.beginPath();
            ctx.moveTo(canvas.width * 0.15, canvas.height - 20);
            ctx.lineTo(canvas.width * 0.85, 20);
            ctx.stroke();
            ctx.restore();
            
            ctx.save();
            const rocketX = canvas.width * 0.15 + (canvas.width * 0.7) * Math.min(gameState.multiplier / 12, 1);
            const rocketY = canvas.height - 20 - (canvas.height - 40) * Math.min(gameState.multiplier / 18, 1);
            
            ctx.translate(rocketX, rocketY);
            
            const angle = Math.atan2(-30, canvas.width * 0.7 / 12);
            ctx.rotate(angle * 0.5);
            
            ctx.shadowColor = '#8a2be2';
            ctx.shadowBlur = 20;
            
            ctx.fillStyle = '#8a2be2';
            ctx.beginPath();
            ctx.moveTo(0, -15);
            ctx.lineTo(10, 0);
            ctx.lineTo(3, 0);
            ctx.lineTo(3, 10);
            ctx.lineTo(-3, 10);
            ctx.lineTo(-3, 0);
            ctx.lineTo(-10, 0);
            ctx.closePath();
            ctx.fill();
            
            ctx.shadowColor = '#ffaa33';
            ctx.fillStyle = '#ffaa33';
            ctx.beginPath();
            ctx.moveTo(-3, 10);
            ctx.lineTo(0, 18);
            ctx.lineTo(3, 10);
            ctx.fill();
            
            ctx.restore();
        }
        
        function drawTraffic() {
            ctx.save();
            
            for (let i = 0; i < trafficLines.length; i++) {
                const line = trafficLines[i];
                
                ctx.strokeStyle = `rgba(138, 43, 226, ${line.alpha})`;
                ctx.lineWidth = line.width;
                ctx.lineCap = 'round';
                
                ctx.beginPath();
                ctx.moveTo(line.x, line.y);
                ctx.lineTo(line.x + 20, line.y - 20);
                ctx.stroke();
                
                ctx.beginPath();
                ctx.moveTo(line.x - 8, line.y + 5);
                ctx.lineTo(line.x + 12, line.y - 15);
                ctx.stroke();
                
                if (i % 2 === 0) {
                    ctx.fillStyle = `rgba(138, 43, 226, ${line.alpha * 0.8})`;
                    ctx.beginPath();
                    ctx.arc(line.x + 10, line.y - 10, line.width * 0.8, 0, Math.PI * 2);
                    ctx.fill();
                }
            }
            
            ctx.restore();
        }
        
        function drawStartScreen() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            ctx.fillStyle = '#000000';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            ctx.fillStyle = 'rgba(138, 43, 226, 0.2)';
            for (let i = 0; i < 40; i++) {
                ctx.beginPath();
                ctx.arc(
                    Math.random() * canvas.width, 
                    Math.random() * canvas.height, 
                    1 + Math.random() * 2, 
                    0, Math.PI * 2
                );
                ctx.fill();
            }
            
            ctx.save();
            ctx.translate(canvas.width / 2, canvas.height - 50);
            ctx.fillStyle = '#8a2be2';
            ctx.shadowColor = '#8a2be2';
            ctx.shadowBlur = 15;
            
            ctx.beginPath();
            ctx.moveTo(0, -25);
            ctx.lineTo(12, 0);
            ctx.lineTo(4, 0);
            ctx.lineTo(4, 15);
            ctx.lineTo(-4, 15);
            ctx.lineTo(-4, 0);
            ctx.lineTo(-12, 0);
            ctx.closePath();
            ctx.fill();
            
            ctx.shadowBlur = 10;
            ctx.fillStyle = '#ffaa33';
            ctx.beginPath();
            ctx.moveTo(-4, 15);
            ctx.lineTo(0, 25);
            ctx.lineTo(4, 15);
            ctx.fill();
            ctx.restore();
            
            ctx.font = 'bold 14px system-ui, -apple-system, sans-serif';
            ctx.fillStyle = '#8a2be2';
            ctx.shadowBlur = 0;
            ctx.fillText('–°–¥–µ–ª–∞–π—Ç–µ —Å—Ç–∞–≤–∫—É', canvas.width/2 - 70, canvas.height/2);
        }
        
        function resizeCanvas() {
            const rect = document.getElementById('game-area').getBoundingClientRect();
            if (rect.width > 0 && rect.height > 0) {
                canvas.width = rect.width;
                canvas.height = rect.height;
                
                if (!gameState.isPlaying) {
                    drawStartScreen();
                } else {
                    drawGame();
                }
            }
        }
        
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–æ–≤
        document.querySelectorAll('.menu-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                document.querySelectorAll('.menu-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                
                const section = btn.dataset.section;
                document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
                document.getElementById(section + '-section').classList.add('active');
                
                if (section === 'traffic') {
                    setTimeout(resizeCanvas, 50);
                }
            });
        });
        
        // –°–º–µ–Ω–∞ –≤–∞–ª—é—Ç—ã
        document.querySelectorAll('.curr-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                document.querySelectorAll('.curr-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentCurr = btn.dataset.curr;
            });
        });
        
        // –ë—ã—Å—Ç—Ä—ã–µ —Å—Ç–∞–≤–∫–∏
        document.querySelectorAll('.quick-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const mult = parseFloat(btn.dataset.mult);
                const currentBet = parseFloat(document.getElementById('bet-input').value);
                document.getElementById('bet-input').value = (currentBet * mult).toFixed(1);
            });
        });
        
        // –§–∏–∫—Å–∞—Ü–∏—è —Å—Ç–∞–≤–∫–∏
        document.getElementById('fix-bet').addEventListener('change', (e) => {
            fixBet = e.target.checked;
        });
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        document.getElementById('bet-btn').addEventListener('click', placeBet);
        document.getElementById('cash-btn').addEventListener('click', cashOut);
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        window.addEventListener('resize', () => {
            setTimeout(resizeCanvas, 50);
        });
        
        setTimeout(() => {
            resizeCanvas();
            initTraffic();
            updateUI();
            drawStartScreen();
            initTelegram();
        }, 100);
    </script>
</body>
</html>
